[<img src="../../images/home.png"> Home ](https://github.com/VFPX/Win32API)  

## Function name : GetLastError
Group: [Error Handling](../../functions_group.md#Error_Handling)  -  Library: [kernel32](../../Libraries.md#kernel32)  
***  


#### The GetLastError function retrieves the calling thread"s last-error code value.
***  


## Code examples:
[Creating a folder](../../samples/sample_001.md)  
[Start an executable from VFP application by using the CreateProcess](../../samples/sample_003.md)  
[Using LoadLibrary](../../samples/sample_007.md)  
[Using the Semaphore object](../../samples/sample_008.md)  
[Using the CreateFile](../../samples/sample_010.md)  
[How to access a file using not its name but an alias (hard link)](../../samples/sample_018.md)  
[Closing Windows](../../samples/sample_036.md)  
[Retrieving local computer and user names](../../samples/sample_041.md)  
[Scanning a hierarchy of child windows down from the Windows Desktop](../../samples/sample_045.md)  
[How to fill a buffer with random bytes using Cryptography API Functions](../../samples/sample_053.md)  
[Converting long file names to the short format and vice versa](../../samples/sample_055.md)  
[Setting the last-error code for the FoxPro](../../samples/sample_058.md)  
[Using FtpCommand](../../samples/sample_059.md)  
[Setting the date and time that a file was created](../../samples/sample_065.md)  
[How to remove FTP directory](../../samples/sample_070.md)  
[Retrieving the System Time adjustment](../../samples/sample_072.md)  
[Placing an arbitrary rectangular area of main VFP window on the Clipboard](../../samples/sample_081.md)  
[Enumerating printer drivers installed](../../samples/sample_082.md)  
[Retrieving a handle to DLL and address of an exported function in it](../../samples/sample_085.md)  
[How to test file attributes (key method for FileExists and DirectoryExists routines)](../../samples/sample_097.md)  
[Basic Volume information](../../samples/sample_098.md)  
[DiskFreeSpace class](../../samples/sample_100.md)  
[Obtaining physical parameters for a drive: sectors, clusters, cylinders...](../../samples/sample_101.md)  
[Wininet last error description](../../samples/sample_109.md)  
[How to download this reference's archive through WinInet functions using InternetOpenUrl](../../samples/sample_110.md)  
[Setting the Window Region for a form](../../samples/sample_120.md)  
[How to initiate System shutdown](../../samples/sample_122.md)  
[Finding parameters for the region specified](../../samples/sample_124.md)  
[Enumerating the subkeys of a user-specific key](../../samples/sample_129.md)  
[Reading current hardware profile](../../samples/sample_134.md)  
[How to save registry key including its subkeys and values to a file](../../samples/sample_135.md)  
[How to find the application associated with a file name](../../samples/sample_138.md)  
[Creating a device context for the specified printer](../../samples/sample_145.md)  
[Using EnumPrinters function to enumerate locally installed printers](../../samples/sample_146.md)  
[Using the Semaphore object to allow only one instance of VFP application running](../../samples/sample_147.md)  
[Setting the volume label](../../samples/sample_151.md)  
[Locking and unlocking file of a VFP table](../../samples/sample_154.md)  
[Retrieving graphic capabilities of default printer](../../samples/sample_155.md)  
[Enumerating Processes -- WinNT](../../samples/sample_162.md)  
[HOWTO: Use the Win32 API to Access File Dates and Times](../../samples/sample_177.md)  
[Custom HttpRequest class (WinINet)](../../samples/sample_185.md)  
[Validating the heap of the calling process](../../samples/sample_200.md)  
[How to write and read Window Properties for the specified window](../../samples/sample_205.md)  
[Converting command-line string to a set of Unicode argument strings](../../samples/sample_212.md)  
[Winsock: retrieving information from a host database for a given host name](../../samples/sample_216.md)  
[Creating a mailslot](../../samples/sample_267.md)  
[Getting a bit more than the _CLIPTEXT offers](../../samples/sample_278.md)  
[Displaying bitmap using the AlphaBlend function](../../samples/sample_293.md)  
[Locking the workstation](../../samples/sample_300.md)  
[Testing serial ports](../../samples/sample_308.md)  
[Converting Unicode data from the Clipboard to a character string using a given code page](../../samples/sample_316.md)  
[How to display the Properties dialog box for a file (ShellExecuteEx)](../../samples/sample_320.md)  
[Determining if an Active Network Connection is Available](../../samples/sample_324.md)  
[How to retrieve information about a cache entry (Internet Explorer)](../../samples/sample_332.md)  
[Enumerating print processors and supporting data types installed on the specified server](../../samples/sample_333.md)  
[Enumerating ports that are available for printing on a specified server](../../samples/sample_334.md)  
[Adding printer to the list of supported printers for the specified server](../../samples/sample_335.md)  
[Reading the structure of VFP main menu](../../samples/sample_337.md)  
[The DetectAutoProxyUrl function identifies the auto-config script location](../../samples/sample_341.md)  
[Custom FTP Class for Visual FoxPro application](../../samples/sample_344.md)  
[How to enumerate cookies and URL History entries in the cache of the local computer](../../samples/sample_350.md)  
[Retrieving the name of the default printer for the current user on the local computer (Win NT/XP)](../../samples/sample_360.md)  
[How to display the port-configuration dialog box for a port on the specified server](../../samples/sample_362.md)  
[How to retrieve the number of print jobs queued for the printer](../../samples/sample_367.md)  
[Enumerating print jobs and retrieving information for default printer (JOB_INFO_1 structures)](../../samples/sample_368.md)  
[How to retrieve configuration data for a specified printer stored in the registry (PrinterDriverData key)](../../samples/sample_369.md)  
[How to delete all print jobs for a printer](../../samples/sample_370.md)  
[Retrieveing information about the active window (even if it is not owned by the calling process)](../../samples/sample_371.md)  
[Simple printer queue monitor: deletes, pauses, resumes print jobs for local printer](../../samples/sample_373.md)  
[Starting external program from VFP and waiting for its termination](../../samples/sample_377.md)  
[How to ping a remote site using IP Helper API calls](../../samples/sample_382.md)  
[Enumerating forms supported by a specified printer](../../samples/sample_390.md)  
[Custom HttpRequest class (WinHTTP)](../../samples/sample_397.md)  
[How to set Creation Date/Time for a folder (WinNT)](../../samples/sample_399.md)  
[Monitoring changes occurring within a directory](../../samples/sample_400.md)  
[Storing registration key in the resources of an executable file](../../samples/sample_401.md)  
[Peer-to-peer LAN messenger built with Mailslot API functions](../../samples/sample_410.md)  
[How to Start a Process as Another User (NT/XP/2K)](../../samples/sample_426.md)  
[How to play AVI file on the _screen](../../samples/sample_430.md)  
[How to block the ALT+TAB shortcut (WinXP)](../../samples/sample_432.md)  
[GetFileOwner - Get the owner of an NTFS file](../../samples/sample_433.md)  
[CryptoAPI: Collection of Providers class](../../samples/sample_463.md)  
[How to run FoxPro application under different user name (impersonating user)](../../samples/sample_470.md)  
[How to delete IE cookies, clear IE history and delete files in Temporary Internet Files directory](../../samples/sample_471.md)  
[Using File Mapping for enumerating files opened by Visual FoxPro](../../samples/sample_473.md)  
[Creating a console window for Visual FoxPro application](../../samples/sample_474.md)  
[Encapsulating access to the Windows Services in a class](../../samples/sample_476.md)  
[How to retrieve version information for the specified file](../../samples/sample_480.md)  
[How to create MD-5 and SHA-1 hash values from a string](../../samples/sample_483.md)  
[How to extract frames from AVI files](../../samples/sample_484.md)  
[Using Change Notification Objects to monitor changes to the printer or print server](../../samples/sample_485.md)  
[How to block the PrintScreen key](../../samples/sample_489.md)  
[How to make application automatically close all documents it opened](../../samples/sample_491.md)  
[How to prevent users from accessing the Windows Desktop and from switching to other applications](../../samples/sample_492.md)  
[Using the NetMessageBufferSend to send messages on the network](../../samples/sample_494.md)  
[Using shared memory to exchange data between applications (processes)](../../samples/sample_498.md)  
[How to display a user-defined icon in the MessageBox dialog](../../samples/sample_500.md)  
[A class that encrypts and decrypts files using Cryptography API Functions](../../samples/sample_511.md)  
[Reading security permissions for NTFS files and folders](../../samples/sample_516.md)  
[How to create a service object](../../samples/sample_517.md)  
[How to delete a service object](../../samples/sample_518.md)  
[How to enumerate sessions and processes on a specified terminal server](../../samples/sample_519.md)  
[How to enumerate terminal servers within the specified Windows domain](../../samples/sample_520.md)  
[Using named pipes for interprocess communication](../../samples/sample_522.md)  
[Reading entries from Event logs](../../samples/sample_524.md)  
[How to find when the application started](../../samples/sample_534.md)  
[Obtaining I/O counts for the current process](../../samples/sample_535.md)  
[Copying files as a transacted operation (Vista)](../../samples/sample_540.md)  
[How to adjust monitor brightness (Vista, monitor with DDC support)](../../samples/sample_543.md)  
[How to enable the SE_SHUTDOWN_NAME privilege for the application](../../samples/sample_552.md)  
[Reading and setting system access privileges for the current process](../../samples/sample_554.md)  
[Printing Image File, programmatically set print page orientation to landscape](../../samples/sample_555.md)  
[How to find which fonts Windows uses for drawing captions, menus and message boxes](../../samples/sample_556.md)  
[Writing entries to custom Event Log](../../samples/sample_564.md)  
[Compressing and decompressing files with Windows API Runtime Library routines](../../samples/sample_568.md)  
[Capturing keyboard activity of another application with the Raw Input API (VFP9)](../../samples/sample_572.md)  
[Displaying dimmed window behind VFP top-level form](../../samples/sample_578.md)  
[Setting default printer](../../samples/sample_589.md)  
[Generating random cryptographic keys](../../samples/sample_590.md)  
[Monitoring clipboard content changes (VFP9)](../../samples/sample_601.md)  
[How to load a user profile](../../samples/sample_602.md)  

## Declaration:
```foxpro  
DWORD GetLastError(VOID);  
```  
***  


## FoxPro declaration:
```foxpro  
DECLARE INTEGER GetLastError IN kernel32  
```  
***  


## Parameters:
This function has no parameters  
***  


## Return value:
The return value is the calling thread"s last-error code value  
***  


## Comments:
To obtain an error string for system error codes, use the FormatMessage function.  
  
The following MS link provides the list of existing error codes:&nbsp;<A href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/win32/hh/psdkref/errlist_9usz.asp">Win32 Error Codes</A>  
  
***  

